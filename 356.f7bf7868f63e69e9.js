(()=>{"use strict";var u,I={356:(u,m,g)=>{class N{}function x(s,e,t){const n=new N;return n.color=s,n.containerIndex=e,n.hidden=t,n}let r=(()=>{class s{constructor(){this.resolved=!1,this._size=0,this.items=[],this.selected=!1}getTopColorCount(){return s.getTopColorCount(this)}static getTopColorCount(t){if(s.isEmpty(t))return 0;let n=1;const i=s.peek(t);let o=s.size(t)-2;for(;o>=0&&t.items[o].color===i;)n++,o--;return n}peek(){return s.peek(this)}static peek(t){const n=s.size(t);if(0==n)throw Error("Container is empty.");return t.items[n-1].color}size(){return this._size}static size(t){return t._size}pop(){return s.pop(this)}static pop(t){const n=t.size();if(0==n)throw Error("Container is empty.");const i=t.items[n-1].color;return t.items[n-1].color=void 0,s.afterChange(t),i}push(t){s.push(this,t)}static push(t,n){const i=s.size(t);if(i==s.MAX_SIZE)throw Error("Size limit exists.");t.items[i].color=n,s.afterChange(t)}isEmpty(){return s.isEmpty(this)}static isEmpty(t){return void 0===t.items[0].color}isFull(){return s.isFull(this)}static isFull(t){return s.size(t)===s.MAX_SIZE}static afterChange(t){s.calculateSize(t),s.checkResolved(t)}static calculateSize(t){t._size=t.items.findIndex(n=>void 0===n.color),-1===t._size&&(t._size=s.MAX_SIZE)}static checkResolved(t){t.resolved=s.size(t)===s.MAX_SIZE&&t.items.every(n=>n.color===s.peek(t))}static create(t){const n=new s;n.index=t;for(let i=0;i<s.MAX_SIZE;i++)n.items.push(x(void 0,t,!1));return s.afterChange(n),n}static isResolved(t){return t.resolved}static equals(t,n){if(s.size(t)!==s.size(n))return!1;for(let i=0;i<s.size(t);i++)if(t.items[i].color!==n.items[i].color)return!1;return!0}static hasOnlyThreeOfOneColor(t){return 3===s.size(t)&&t.items[0].color===t.items[1].color&&t.items[0].color===t.items[2].color}static hasOnlyTwoOfOneColor(t){return 2===s.size(t)&&t.items[0].color===t.items[1].color}static hasOnlyOneOfOneColor(t){return 1===s.size(t)}static hasOnlyOneColor(t){return!s.isEmpty(t)&&t.items.every(n=>void 0===n.color||n.color===t.items[0].color)}static containerClone(t){const n=s.create(t.index);return t.items.forEach((i,o)=>n.items[o].color=i.color),s.afterChange(n),n}static containersClone(t){return t.map(n=>s.containerClone(n))}}return s.MAX_SIZE=4,s})();class a{constructor(){this.containers=[]}}function k(s){let e=!0,t=0;for(;t<s.containers.length;){let n=s.containers[t];r.isEmpty(n)?t++:r.isResolved(n)?s.containers.splice(t,1):(e=!1,t++)}return e}function z(s){const e=new a;return e.containers=s.containers.map(t=>r.containerClone(t)),e}function E(s,e){return s.containers.filter(t=>r.equals(t,e)).length}function F(s,e){return s.some(t=>function M(s,e){if(s.containers.length!==e.containers.length)return!1;for(let t=0;t<s.containers.length;t++)if(E(e,s.containers[t])!==E(s,s.containers[t]))return!1;return!0}(t,e))}function O(s,e){e instanceof a?F(s,e)||s.push(e):s=[...s,...e]}class T{constructor(e,t,n){this.notes="",this.iFrom=e,this.iTo=t,this.color=n}clone(){const e=new T(this.iFrom,this.iTo,this.color);return e.notes=this.notes,e}equals(e){return this.iFrom===e.iFrom&&this.iTo===e.iTo&&this.color===e.color}}var f=(()=>{return(s=f||(f={}))[s.CANCEL=0]="CANCEL",s[s.NO_SOLUTION=1]="NO_SOLUTION",s[s.SOLUTION=2]="SOLUTION",s[s.BEST_SOLUTION=3]="BEST_SOLUTION",f;var s})();class w{constructor(){this.stepCount=0,this.oldBoards=[],this.steps=[]}}function d(s,e,t,n,i){s=z(s);for(let o=0;o<n;o++)r.push(s.containers[t],r.pop(s.containers[e])),i.steps.push(new T(s.containers[e].index,s.containers[t].index,s.containers[t].items[r.size(s.containers[t])-1].color));return i.board=s,i.stepCount=i.stepCount+n,O(i.oldBoards,s),s}class X{constructor(){this.steps=[]}}class Z{constructor(){this.solutions=[]}}class H{constructor(){this.containers=[],this.oldBoards=[],this.steps=[],this.solutions=new Z,this.bestSolution=void 0,this.counter=0,this.logicFunctions=[]}}function v(s,e,t){if(s.counter++,k(e))return void L(s);const n=function K(s,e){const t=new w;let n=!0;for(;n;)n=!1,s.logicFunctions.forEach(i=>{const o=i(e);o.stepCount>0&&(n=!0,e=o.board,t.stepCount=t.stepCount+o.stepCount,O(t.oldBoards,o.oldBoards),t.steps=[...t.steps,...o.steps])});return t.board=e,t}(s,e);if(n.stepCount>0&&(e=n.board,t+=n.stepCount,O(s.oldBoards,n.oldBoards),s.steps=[...s.steps,...n.steps],k(e)))L(s);else for(let i=0;i<e.containers.length;i++)for(let o=0;o<e.containers.length;o++)i!==o&&Q(s,e,i,o,t)}function Q(s,e,t,n,i){r.isEmpty(e.containers[t])||r.isFull(e.containers[n])||!r.isEmpty(e.containers[n])&&r.peek(e.containers[t])!=r.peek(e.containers[n])||1==r.size(e.containers[t])&&r.isEmpty(e.containers[n])||r.hasOnlyThreeOfOneColor(e.containers[t])||r.hasOnlyOneColor(e.containers[t])&&r.isEmpty(e.containers[n])||(e=function V(s,e,t){return s=z(s),r.push(s.containers[t],r.pop(s.containers[e])),s}(e,t,n),!F(s.oldBoards,e)&&(s.steps.push(new T(e.containers[t].index,e.containers[n].index,e.containers[n].items[r.size(e.containers[n])-1].color)),O(s.oldBoards,e),v(s,e,i+1),function Y(s,e){for(;s.steps.length>e;)s.steps.pop()}(s,i)))}function L(s){const e=function $(s){const e=s.steps;let o=0,p=!0;for(;p;){for(p=!1,o=0;o<e.length-1;){let c=o+1;for(;c<e.length&&(e[o].iFrom!==e[c].iTo||e[o].iTo!==e[c].iFrom)&&e[o].iFrom!==e[c].iFrom&&e[o].iFrom!==e[c].iTo&&e[o].iTo!==e[c].iFrom&&e[o].iTo!==e[c].iTo;)c++;c<e.length&&e[o].iFrom===e[c].iTo&&e[o].iTo===e[c].iFrom?(e.splice(c,1),e.splice(o,1),p=!0):o++}for(o=0;o<e.length-1;){let l=o+1;for(;l<e.length&&e[o].iTo!==e[l].iFrom;)l++;if(l<e.length&&e[o].iTo===e[l].iFrom){let c=l-1,C=!1;for(;o<c;){if((e[c].iFrom===e[l].iFrom||e[c].iFrom===e[l].iTo||e[c].iTo===e[l].iFrom||e[c].iTo===e[l].iTo)&&e[c].color!==e[l].color){C=!0;break}c--}!1===C?(e[o].iTo=e[l].iTo,e[o].notes="Updated by optimization 2",e.splice(l,1),p=!0):o++}else o++}for(o=0;o<e.length-1;)e[o].iFrom===e[o].iTo?(e.splice(o,1),p=!0):o++}return s}(function j(s){const e=new X;return e.steps=[],s.forEach(t=>e.steps.push(t.clone())),e}(s.steps));(function G(s,e){return!s.solutions.some(t=>function q(s,e){if(s.steps.length!==e.steps.length)return!1;for(let t=0;t<s.steps.length;t++)if(!s.steps[t].equals(e.steps[t]))return!1;return!0}(t,e))&&(s.solutions.push(e),!0)})(s.solutions,e)&&(void 0===s.bestSolution||e.steps.length<s.bestSolution.steps.length)&&(s.bestSolution=e,S(f.SOLUTION,e))}function S(s,e){postMessage({result:s,solution:e})}addEventListener("message",({data:s})=>{!function J(s){const e=new H;e.containers=s,e.oldBoards=[],e.steps=[],e.solutions.solutions=[],e.bestSolution=void 0,e.counter=0,e.logicFunctions.push(function A(){return e=>{const t=new w;let n=!0;for(;n;){n=!1;for(let i=0;i<e.containers.length;i++)if(r.hasOnlyThreeOfOneColor(e.containers[i])){const o=s(e,e.containers[i].items[0].color,i);if(-1!==o){e=d(e,o,i,1,t),n=!0;break}}}return t};function s(e,t,n){for(let i=0;i<e.containers.length;i++)if(i!==n&&!r.isEmpty(e.containers[i])&&r.peek(e.containers[i])===t)return i;return-1}}()),e.logicFunctions.push(function R(){return e=>{const t=new w;let n=!0;for(;n;){n=!1;for(let i=0;i<e.containers.length;i++)if(r.hasOnlyTwoOfOneColor(e.containers[i])){const o=s(e,e.containers[i].items[0].color,i);if(-1!==o){e=d(e,o,i,2,t),n=!0;break}}}return t};function s(e,t,n){for(let i=0;i<e.containers.length;i++)if(i!==n&&r.size(e.containers[i])>1&&e.containers[i].items[r.size(e.containers[i])-1].color===t&&e.containers[i].items[r.size(e.containers[i])-2].color===t)return i;return-1}}()),e.logicFunctions.push(function y(){return e=>{const t=new w;let n=!0;for(;n;){n=!1;for(let i=0;i<e.containers.length;i++)if(r.hasOnlyOneOfOneColor(e.containers[i])){const o=s(e,e.containers[i].items[0].color,i);if(-1!==o){e=d(e,o,i,3,t),n=!0;break}}}return t};function s(e,t,n){for(let i=0;i<e.containers.length;i++)if(i!==n&&4==r.size(e.containers[i])&&e.containers[i].items[r.size(e.containers[i])-1].color===t&&e.containers[i].items[r.size(e.containers[i])-2].color===t&&e.containers[i].items[r.size(e.containers[i])-3].color===t)return i;return-1}}()),v(e,z(function U(s){const e=new a;return void 0!==s&&(e.containers=s,e.containers.forEach(t=>r.afterChange(t))),e}(e.containers)),0),void 0===e.bestSolution?S(f.NO_SOLUTION,void 0):S(f.BEST_SOLUTION,e.bestSolution)}(s)})}},h={};h.m=I,h.u=u=>u+".acfd0029abcdacc9.js",h.o=(u,m)=>Object.prototype.hasOwnProperty.call(u,m),h.tt=()=>(void 0===u&&(u={createScriptURL:m=>m},typeof trustedTypes<"u"&&trustedTypes.createPolicy&&(u=trustedTypes.createPolicy("angular#bundler",u))),u),h.tu=u=>h.tt().createScriptURL(u),h.p="",h.b=self.location+"",I[356](0,{},h)})();
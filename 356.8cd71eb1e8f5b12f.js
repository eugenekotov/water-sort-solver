(()=>{"use strict";var u,L={356:(u,w,T)=>{class P{}function R(t,e,n){const i=new P;return i.color=t,i.containerIndex=e,i.hidden=n,i}let p=(()=>{class t{constructor(){this.resolved=!1,this._size=0,this.items=[]}}return t.MAX_SIZE=4,t})();function m(t){(function Z(t){t._size=t.items.findIndex(e=>void 0===e.color),-1===t._size&&(t._size=p.MAX_SIZE)})(t),function q(t){t.resolved=r(t)===p.MAX_SIZE&&t.items.every(e=>e.color===S(t))}(t)}function v(t,e){const n=r(t);if(n==p.MAX_SIZE)throw Error("Size limit exists.");t.items[n].color=e,m(t)}function S(t){const e=r(t);if(0==e)throw Error("Container is empty.");return t.items[e-1].color}function k(t){const e=r(t);if(0==e)throw Error("Container is empty.");const n=t.items[e-1].color;return t.items[e-1].color=void 0,m(t),n}function r(t){return t._size}function a(t){return void 0===t.items[0].color}function H(t){return t.resolved}function E(t){return 3===r(t)&&t.items[0].color===t.items[1].color&&t.items[0].color===t.items[2].color}function J(t){return 2===r(t)&&t.items[0].color===t.items[1].color}function K(t){return 1===r(t)}class _{constructor(){this.containers=[]}}function B(t){let e=!0,n=0;for(;n<t.containers.length;){let i=t.containers[n];a(i)?n++:H(i)?t.containers.splice(n,1):(e=!1,n++)}return e}function y(t){const e=new _;return e.containers=t.containers.map(n=>function V(t){const e=function X(t){const e=new p;e.index=t;for(let n=0;n<p.MAX_SIZE;n++)e.items.push(R(void 0,t,!1));return m(e),e}(t.index);return t.items.forEach((n,i)=>e.items[i].color=n.color),m(e),e}(n)),e}function N(t,e){return t.containers.filter(n=>function G(t,e){if(r(t)!==r(e))return!1;for(let n=0;n<r(t);n++)if(t.items[n].color!==e.items[n].color)return!1;return!0}(n,e)).length}function x(t,e){return t.some(n=>function $(t,e){if(t.containers.length!==e.containers.length)return!1;for(let n=0;n<t.containers.length;n++)if(N(e,t.containers[n])!==N(t,t.containers[n]))return!1;return!0}(n,e))}function O(t,e){e instanceof _?x(t,e)||t.push(e):t=[...t,...e]}class C{constructor(e,n,i){this.notes="",this.iFrom=e,this.iTo=n,this.color=i}clone(){const e=new C(this.iFrom,this.iTo,this.color);return e.notes=this.notes,e}equals(e){return this.iFrom===e.iFrom&&this.iTo===e.iTo&&this.color===e.color}}var f=(()=>{return(t=f||(f={}))[t.CANCEL=0]="CANCEL",t[t.NO_SOLUTION=1]="NO_SOLUTION",t[t.SOLUTION=2]="SOLUTION",t[t.BEST_SOLUTION=3]="BEST_SOLUTION",f;var t})();class d{constructor(){this.stepCount=0,this.oldBoards=[],this.steps=[]}}function F(t,e,n,i,s){t=y(t);for(let o=0;o<i;o++)v(t.containers[n],k(t.containers[e])),s.steps.push(new C(t.containers[e].index,t.containers[n].index,t.containers[n].items[r(t.containers[n])-1].color));return s.board=t,s.stepCount=s.stepCount+i,O(s.oldBoards,t),t}class ee{constructor(){this.steps=[]}}class te{constructor(){this.solutions=[]}}class oe{constructor(){this.containers=[],this.oldBoards=[],this.steps=[],this.solutions=new te,this.bestSolution=void 0,this.counter=0,this.logicFunctions=[]}}function U(t,e,n){if(t.counter++,B(e))return void z(t);const i=function ce(t,e){const n=new d;let i=!0;for(;i;)i=!1,t.logicFunctions.forEach(s=>{const o=s(e);o.stepCount>0&&(i=!0,e=o.board,n.stepCount=n.stepCount+o.stepCount,O(n.oldBoards,o.oldBoards),n.steps=[...n.steps,...o.steps])});return n.board=e,n}(t,e);if(i.stepCount>0&&(e=i.board,n+=i.stepCount,O(t.oldBoards,i.oldBoards),t.steps=[...t.steps,...i.steps],B(e)))z(t);else for(let s=0;s<e.containers.length;s++)for(let o=0;o<e.containers.length;o++)s!==o&&le(t,e,s,o,n)}function le(t,e,n,i,s){a(e.containers[n])||function j(t){return r(t)===p.MAX_SIZE}(e.containers[i])||!a(e.containers[i])&&S(e.containers[n])!=S(e.containers[i])||1==r(e.containers[n])&&a(e.containers[i])||E(e.containers[n])||function Q(t){return!a(t)&&t.items.every(e=>void 0===e.color||e.color===t.items[0].color)}(e.containers[n])&&a(e.containers[i])||(e=function ue(t,e,n){return v((t=y(t)).containers[n],k(t.containers[e])),t}(e,n,i),!x(t.oldBoards,e)&&(t.steps.push(new C(e.containers[n].index,e.containers[i].index,e.containers[i].items[r(e.containers[i])-1].color)),O(t.oldBoards,e),U(t,e,s+1),function fe(t,e){for(;t.steps.length>e;)t.steps.pop()}(t,s)))}function z(t){const e=function he(t){const e=t.steps;let o=0,g=!0;for(;g;){for(g=!1,o=0;o<e.length-1;){let c=o+1;for(;c<e.length&&(e[o].iFrom!==e[c].iTo||e[o].iTo!==e[c].iFrom)&&e[o].iFrom!==e[c].iFrom&&e[o].iFrom!==e[c].iTo&&e[o].iTo!==e[c].iFrom&&e[o].iTo!==e[c].iTo;)c++;c<e.length&&e[o].iFrom===e[c].iTo&&e[o].iTo===e[c].iFrom?(e.splice(c,1),e.splice(o,1),g=!0):o++}for(o=0;o<e.length-1;){let l=o+1;for(;l<e.length&&e[o].iTo!==e[l].iFrom;)l++;if(l<e.length&&e[o].iTo===e[l].iFrom){let c=l-1,M=!1;for(;o<c;){if((e[c].iFrom===e[l].iFrom||e[c].iFrom===e[l].iTo||e[c].iTo===e[l].iFrom||e[c].iTo===e[l].iTo)&&e[c].color!==e[l].color){M=!0;break}c--}!1===M?(e[o].iTo=e[l].iTo,e[o].notes="Updated by optimization 2",e.splice(l,1),g=!0):o++}else o++}for(o=0;o<e.length-1;)e[o].iFrom===e[o].iTo?(e.splice(o,1),g=!0):o++}return t}(function ne(t){const e=new ee;return e.steps=[],t.forEach(n=>e.steps.push(n.clone())),e}(t.steps));(function ie(t,e){return!t.solutions.some(n=>function se(t,e){if(t.steps.length!==e.steps.length)return!1;for(let n=0;n<t.steps.length;n++)if(!t.steps[n].equals(e.steps[n]))return!1;return!0}(n,e))&&(t.solutions.push(e),!0)})(t.solutions,e)&&(void 0===t.bestSolution||e.steps.length<t.bestSolution.steps.length)&&(t.bestSolution=e,I(f.SOLUTION,e))}function I(t,e){postMessage({result:t,solution:e})}addEventListener("message",({data:t})=>{!function re(t){const e=new oe;e.containers=t,e.oldBoards=[],e.steps=[],e.solutions.solutions=[],e.bestSolution=void 0,e.counter=0,e.logicFunctions.push(function W(){return e=>{const n=new d;let i=!0;for(;i;){i=!1;for(let s=0;s<e.containers.length;s++)if(E(e.containers[s])){const o=t(e,e.containers[s].items[0].color,s);if(-1!==o){e=F(e,o,s,1,n),i=!0;break}}}return n};function t(e,n,i){for(let s=0;s<e.containers.length;s++)if(s!==i&&!a(e.containers[s])&&S(e.containers[s])===n)return s;return-1}}()),e.logicFunctions.push(function D(){return e=>{const n=new d;let i=!0;for(;i;){i=!1;for(let s=0;s<e.containers.length;s++)if(J(e.containers[s])){const o=t(e,e.containers[s].items[0].color,s);if(-1!==o){e=F(e,o,s,2,n),i=!0;break}}}return n};function t(e,n,i){for(let s=0;s<e.containers.length;s++)if(s!==i&&r(e.containers[s])>1&&e.containers[s].items[r(e.containers[s])-1].color===n&&e.containers[s].items[r(e.containers[s])-2].color===n)return s;return-1}}()),e.logicFunctions.push(function b(){return e=>{const n=new d;let i=!0;for(;i;){i=!1;for(let s=0;s<e.containers.length;s++)if(K(e.containers[s])){const o=t(e,e.containers[s].items[0].color,s);if(-1!==o){e=F(e,o,s,3,n),i=!0;break}}}return n};function t(e,n,i){for(let s=0;s<e.containers.length;s++)if(s!==i&&4==r(e.containers[s])&&e.containers[s].items[r(e.containers[s])-1].color===n&&e.containers[s].items[r(e.containers[s])-2].color===n&&e.containers[s].items[r(e.containers[s])-3].color===n)return s;return-1}}()),U(e,y(function Y(t){const e=new _;return void 0!==t&&(e.containers=t,e.containers.forEach(n=>m(n))),e}(e.containers)),0),void 0===e.bestSolution?I(f.NO_SOLUTION,void 0):I(f.BEST_SOLUTION,e.bestSolution)}(t)})}},h={};h.m=L,h.u=u=>u+".8cd71eb1e8f5b12f.js",h.o=(u,w)=>Object.prototype.hasOwnProperty.call(u,w),h.tt=()=>(void 0===u&&(u={createScriptURL:w=>w},typeof trustedTypes<"u"&&trustedTypes.createPolicy&&(u=trustedTypes.createPolicy("angular#bundler",u))),u),h.tu=u=>h.tt().createScriptURL(u),h.p="",h.b=self.location+"",L[356](0,{},h)})();
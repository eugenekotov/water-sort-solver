<div class="view-container" [ngStyle]="mainService.visible.get('setup') ? {'opacity' : 1} : {'opacity' : 0}">

  <div class="title-container">

    <div class="title-buttons" [ngClass]="mainService.isMobile ? 'title-buttons-small' : 'title-buttons-large'">

      <button class="fab" [ngClass]="mainService.isMobile ? 'fab-small' : 'fab-large'"
        (click)="tourService.startTour(tour)">?</button>

    </div>
  </div>

  <div class="text-containers-parent">
    <div class="header-text" [ngClass]="mainService.isMobile ? 'header-text-small' : 'header-text-large'">
      {{ 'SETUP.TITLE_1' | translate }}
    </div>
  </div>

  <div class="source-containers-parent">
    <div id="source-containers" class="source-containers shadow-inset"
      [ngClass]="mainService.isMobile ? 'source-containers-small' : 'source-containers-large'">

      <div *ngFor="let item of mainService.sourceItems" class="source-container"
        [ngClass]="mainService.isMobile ? 'source-container-small' : 'source-container-large'" (click)="onSourceItemClick($event, item)">

        <div [attr.id]="getSourceItemId(item)" class="shadow" [ngClass]="mainService.isMobile ? 'item-small source-item-small' : 'item-large source-item-large'"
          [ngStyle]="getSourceItemStyle(item)">
        </div>

        <div class="source-item-count shadow" [ngClass]="mainService.isMobile ? 'source-item-count-small' : 'source-item-count-large'"
          [ngStyle]="item.count > 0 ? {'opacity' : 1} : {'opacity' : 1}">

          {{item.count}}
        </div>
      </div>
    </div>

    <div id="buttons-add-remove" style="display: flex; gap: 0.5rem; margin: 5px;">
      <button class="fab" [ngClass]="mainService.isMobile ? 'fab-small' : 'fab-large'" (click)="addContainer()">
        <div style="display: flex; justify-content: center;">
          <mat-icon [ngClass]="mainService.isMobile ? 'mat-icon-small' : 'mat-icon-large'">add</mat-icon>
        </div>
      </button>
      <button class="fab" [ngClass]="mainService.isMobile ? 'fab-small' : 'fab-large'" (click)="removeContainer()">
        <div style="display: flex; justify-content: center;">
          <mat-icon [ngClass]="mainService.isMobile ? 'mat-icon-small' : 'mat-icon-large'">remove</mat-icon>
        </div>
      </button>
    </div>
  </div>

  <div class="setup-containers" [ngClass]="mainService.isMobile ? 'setup-containers-small' : 'setup-containers-large'">
    <!-- Duplicate for position -->
    <div class="containers-2" [ngClass]="mainService.isMobile ? 'containers-2-small' : 'containers-2-large'"
      style="position: absolute; opacity: 0; z-index: 0;">
      <div class="containers" [ngClass]="mainService.isMobile ? 'containers-small' : 'containers-large'">
        <div *ngFor="let container of setupContainerPositions1" class="container"
          [ngClass]="mainService.isMobile ? 'container-small' : 'container-large'" style="flex-direction: column-reverse;">

          <div *ngFor="let color of container.colors; let itemIndex=index" [id]="getSetupContainerPositionItemId(container.id, itemIndex)"
            class="item" [ngClass]="mainService.isMobile ? 'item-small' : 'item-large'">
          </div>
        </div>
      </div>
      <div *ngIf="mainService.setupContainers2.length > 0" class="containers"
        [ngClass]="mainService.isMobile ? 'containers-small' : 'containers-large'">
        <div *ngFor="let container of setupContainerPositions2" class="container"
          [ngClass]="mainService.isMobile ? 'container-small' : 'container-large'" style="flex-direction: column-reverse;">

          <div *ngFor="let color of container.colors; let itemIndex=index" [id]="getSetupContainerPositionItemId(container.id, itemIndex)"
            class="item" [ngClass]="mainService.isMobile ? 'item-small' : 'item-large'">
          </div>
        </div>
      </div>
    </div>
    <!--  -->
    <div id="containers" class="containers-2" [ngClass]="mainService.isMobile ? 'containers-2-small' : 'containers-2-large'"
      style="z-index: 6;">
      <div class="containers" [ngClass]="mainService.isMobile ? 'containers-small' : 'containers-large'">
        <div *ngFor="let container of mainService.setupContainers1" [id]="container.id"
          class="container" [ngClass]="mainService.isMobile ? 'container-small' : 'container-large'"
          cdkDropList [cdkDropListData]="container.colors"
          [cdkDropListConnectedTo]="getConnectedLists(container.id)" (cdkDropListDropped)="drop($event)"
          [cdkDropListEnterPredicate]="canDrop(container)"
          (click)="onSetupContainerClick($event, container)" >

          <div *ngFor="let color of container.colors" class="item shadow shadow-active" [ngClass]="mainService.isMobile ? 'item-small' : 'item-large'"
            [ngStyle]="getItemStyle(color)" cdkDrag>
          </div>
        </div>
      </div>

      <div *ngIf="mainService.setupContainers2.length > 0" class="containers" [ngClass]="mainService.isMobile ? 'containers-small' : 'containers-large'">
        <div *ngFor="let container of mainService.setupContainers2" [id]="container.id"
          class="container" [ngClass]="mainService.isMobile ? 'container-small' : 'container-large'"
          cdkDropList [cdkDropListData]="container.colors"
          [cdkDropListConnectedTo]="getConnectedLists(container.id)" (cdkDropListDropped)="drop($event)"
          [cdkDropListEnterPredicate]="canDrop(container)"
          (click)="onSetupContainerClick($event, container)">

          <div *ngFor="let color of container.colors" class="item shadow shadow-active" [ngClass]="mainService.isMobile ? 'item-small' : 'item-large'"
            [ngStyle]="getItemStyle(color)" cdkDrag>
          </div>
        </div>
      </div>
    </div>
  </div>

  <ng-container *ngIf="mainService.isMobile">
    <div>
      <div class="buttons-container buttons-container-small">
        <button id="button-clear" class="button button-small" (click)="clearClick()" [disabled]="filling">{{ "SETUP.CLEAR" | translate }}</button>
        <button id="button-fill" class="button button-small" (click)="fillRandomly()" [disabled]="filling">{{ "SETUP.FILL_RANDOM" | translate }}</button>
      </div>
      <div class="buttons-container buttons-container-small">
        <button id="button-save" class="button button-small" (click)="saveClick()" [disabled]="filling || !saveEnabled">{{ "SETUP.SAVE" | translate }}</button>
        <button id="button-load" class="button button-small" (click)="loadClick()" [disabled]="filling || !loadEnabled">{{ "SETUP.LOAD" | translate }}</button>
      </div>
      <div class="buttons-container buttons-container-small">
        <button id="button-solve" class="button button-small" (click)="solveClick()" [disabled]="filling">{{ "SETUP.SOLVE" | translate }}</button>
        <button id="button-play" class="button button-small" (click)="playClick()" [disabled]="filling">{{ "SETUP.PLAY" | translate }}</button>
      </div>
    </div>
  </ng-container>

  <ng-container *ngIf="!mainService.isMobile">
    <div class="buttons-container buttons-container-large">
      <button id="button-clear" class="button button-large" (click)="clearClick()" [disabled]="filling">{{ "SETUP.CLEAR" | translate }}</button>
      <button id="button-fill" class="button button-large mr-1" (click)="fillRandomly()" [disabled]="filling">{{ "SETUP.FILL_RANDOM" | translate }}</button>
      <button id="button-save" class="button button-large" (click)="saveClick()" [disabled]="filling || !saveEnabled">{{ "SETUP.SAVE" | translate }}</button>
      <button id="button-load" class="button button-large mr-1" (click)="loadClick()" [disabled]="filling || !loadEnabled">{{ "SETUP.LOAD" | translate }}</button>
      <button id="button-solve" class="button button-large" (click)="solveClick()" [disabled]="filling">{{ "SETUP.SOLVE" | translate }}</button>
      <button id="button-play" class="button button-large" (click)="playClick()" [disabled]="filling">{{ "SETUP.PLAY" | translate }}</button>
    </div>
  </ng-container>

  <app-moving-item class="moving-item" [item]="movingItem" (click)="onMovingItemClick(movingItem)"></app-moving-item>

</div>
